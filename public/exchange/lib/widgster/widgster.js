!function(e){"use strict";var t=function(t,s){this.$element=e(t),this.$collapse=this.$element.find("[data-widgster=collapse]"),this.$expand=this.$element.find("[data-widgster=expand]"),this.$fullscreen=this.$element.find("[data-widgster=fullscreen]"),this.$restore=this.$element.find("[data-widgster=restore]"),this.options=s,this.collapsed=s.collapsed,this.fullscreened=s.fullscreened,this._initHandlers(),this.collapsed?this.collapse(!1):this.$expand.hide(),this.fullscreened?this.fullscreen():this.$restore.hide(),this.options.autoload&&this.load();var i=parseInt(this.options.autoload);if(!isNaN(i)){var o=this;this._autoloadInterval=setInterval(function(){o.load()},i)}};t.DEFAULTS={collapsed:!1,fullscreened:!1,transitionDuration:150,bodySelector:".body",showLoader:!0,autoload:!1,loaderTemplate:'<div style="text-align: center; margin-top: 10px;">Loading...</div>',closePrompt:function(e){e()}},t.prototype.collapse=function(t){t=void 0===t||t;var s=e.Event("collapse.widgster");if(this.$element.trigger(s),!s.isDefaultPrevented()){var i=this,o=t?this.options.transitionDuration:0;return this.$element.find(this.options.bodySelector).slideUp(o,function(){i.$element.addClass("collapsed"),i.$element.trigger(e.Event("collapsed.widgster")),i.collapsed=!0}),this.$collapse.hide(),this.$expand.show(),!1}},t.prototype.expand=function(t){t=void 0===t||t;var s=e.Event("expand.widgster");if(this.$element.trigger(s),!s.isDefaultPrevented()){var i=this,o=t?this.options.transitionDuration:0;return this.$element.find(this.options.bodySelector).slideDown(o,function(){i.$element.removeClass("collapsed"),i.$element.trigger(e.Event("expanded.widgster")),i.collapsed=!1}),this.$collapse.show(),this.$expand.hide(),!1}},t.prototype.close=function(){return this.options.closePrompt&&this.options.closePrompt(e.proxy(this._doClose,this)),!1},t.prototype.load=function(){var t=e.Event("load.widgster");if(this.$element.trigger(t),!t.isDefaultPrevented()){var s=this;return this.$element.find(this.options.bodySelector).load(this.options.load,function(t,i,o){s.expand(),s.options.showLoader&&s._hideLoader(),s.$element.trigger(e.Event("loaded.widgster",{responseText:t,textStatus:i,xhr:o}))}),this.options.showLoader&&this._showLoader(),!1}},t.prototype.fullscreen=function(){var t=e.Event("fullscreen.widgster");if(this.$element.trigger(t),!t.isDefaultPrevented())return this.$element.css({position:"fixed",top:0,right:0,bottom:0,left:0,margin:0,"z-index":1e4}),e("body").css("overflow","hidden"),this.wasCollapsed=this.collapsed,this.expand(!1),this.$fullscreen.hide(),this.$restore.show(),this.$collapse.hide(),this.$expand.hide(),this.$element.addClass("fullscreened"),this.$element.trigger(e.Event("fullscreened.widgster")),!1},t.prototype.restore=function(){var t=e.Event("restore.widgster");if(this.$element.trigger(t),!t.isDefaultPrevented())return this.$element.css({position:"",top:"",right:"",bottom:"",left:"",margin:"","z-index":""}),e("body").css("overflow",""),this.$fullscreen.show(),this.$restore.hide(),this.collapsed?(this.$collapse.hide(),this.$expand.show()):(this.$collapse.show(),this.$expand.hide()),this.wasCollapsed&&this.collapse(!1),this.$element.removeClass("fullscreened"),this.$element.trigger(e.Event("restored.widgster")),!1},t.prototype._doClose=function(){var t=e.Event("close.widgster");this.$element.trigger(t),t.isDefaultPrevented()||(e("body").css("overflow",""),this.$element.detach(),t=e.Event("closed.widgster",{$element:this.$element}),this.$element.trigger(t))},t.prototype._showLoader=function(){var t=this.$element.find(this.options.bodySelector);this.$loaderWrap=this.$element.find(".widgster-loader-wrap"),0==this.$loaderWrap.length&&(this.$loaderWrap=e('<div class="widgster-loader-wrap" style="position: absolute; top: 0; right: 0; bottom: 0; left: 0; display: none"></div>'),this.$element.append(this.$loaderWrap)),this.$loaderWrap.html(this.options.loaderTemplate),this.$loaderWrap.css({"margin-top":t.position().top}),this.collapsed||(t.fadeTo(this.options.transitionDuration,0),this.$loaderWrap.fadeIn(this.options.transitionDuration))},t.prototype._hideLoader=function(){this.$loaderWrap.fadeOut(this.options.transitionDuration),this.$element.find(this.options.bodySelector).fadeTo(this.options.transitionDuration,1)},t.prototype._initHandlers=function(){this.$element.on("click.collapse.widgster","[data-widgster=collapse]",e.proxy(this.collapse,this)),this.$element.on("click.expand.widgster","[data-widgster=expand]",e.proxy(this.expand,this)),this.$element.on("click.close.widgster","[data-widgster=close]",e.proxy(this.close,this)),this.$element.on("click.load.widgster","[data-widgster=load]",e.proxy(this.load,this)),this.$element.on("click.fullscreen.widgster","[data-widgster=fullscreen]",e.proxy(this.fullscreen,this)),this.$element.on("click.restore.widgster","[data-widgster=restore]",e.proxy(this.restore,this))},e.fn.widgster=function(s){return this.each(function(){var i=e(this),o=i.data("widgster"),n=e.extend({},t.DEFAULTS,function(e,t){var s={};for(var i in t)if(i.slice(0,e.length)==e){var o=i.slice(e.length,i.length);s[o=o.charAt(0).toLowerCase()+o.slice(1)]=t[i]}return s}("widgster",i.data()),"object"==typeof s&&s);o||i.data("widgster",new t(this,n)),"string"==typeof s&&o[s]()})},e.fn.widgster.Constructor=t}(window.jQuery);